<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Basic Example</title>
    <link rel="stylesheet" href="css/base.css" />
  </head>
  <body>
    <section class="AuthTestApp"></section>
   
    <script src="js/react.js"></script>
    <script src="js/react-dom.js"></script>
   
    <script>
    
    
    var TimerExample = React.createClass({

    getInitialState: function(){

        // Это выполняется перед функцией render. Возвращаемый объект 
        // присваивается в this.state, чтобы мы могли использовать его позже.

        return { elapsed: 0 };
    },

    componentDidMount: function(){

        // componentDidMount вызывается react'ом, когда компонент 
        // был отрисован на странице. Мы можем установить интервал здесь:

        this.timer = setInterval(this.tick, 50);
    },

    componentWillUnmount: function(){

        // Этот метод вызывается сразу после того, как компонент удален
        // со страницы и уничтожен. Мы можем удалить интервал здесь:

        clearInterval(this.timer);
    },

    tick: function(){

        // Эта функция вызывается каждые 50мс. Она обновляет 
        // счетчик затраченного времени. Вызов setState заставляет компонент перерисовываться

        this.setState({elapsed: new Date() - this.props.start});
    },

    render: function() {
        
        var elapsed = Math.round(this.state.elapsed / 100);

        // Это даст нам число с одной цифрой после запятой dot (xx.x):
        var seconds = (elapsed / 10).toFixed(1);    

        // Хоть мы и возвращаем целый <p> элемент, react разумно обновит
        // только измененные части, содержащие переменную seconds.

        return <p>This example was started <b>{seconds} seconds</b> ago.</p>;
    }
});


React.renderComponent(
    <TimerExample start={Date.now()} />,
    document.body
);

    
    
    
    
      var id = null;
      var auth = null;
      if (id == null) {auth = null}
      else {auth = 1}
      var AuthApp = React.CreateClass({
        render: function(){
          if(auth == 1){
            return <a href="https://oauth.vk.com/authorize?client_id=5572694&display=page&redirect_uri=http://artsmolin.github.io&scope=friends&response_type=token&v=5.53">Войти через ВК</a>;;
          }
          else {
            return  <a href="https://oauth.vk.com/authorize?client_id=5572694&display=page&redirect_uri=http://artsmolin.github.io&scope=friends&response_type=token&v=5.53">Войти через ВК</a>;
          }
        }  
      });
    
      var url = window.location.hash;
      var arr = url.split("=");
      var pre_token = arr[1];
      var arr_token = pre_token.split("&");
      var token = arr_token[0];
      id = arr[3];

      var script = document.createElement('SCRIPT'); 
      script.src = "https://api.vk.com/method/users.get?user_ids=" + id + "&fields=bdate&v=5.53&callback=callbackFunc"; 
      document.getElementsByTagName("head")[0].appendChild(script); 
      function callbackFunc(result) { 
        alert(result.response[0].first_name) 
      }
      
      React.renderComponent(
        <AuthApp/>,
        document.body
      );
    </script>
  </body>
</html>
